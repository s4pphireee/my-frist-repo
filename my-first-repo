#include <iostream>
#include <cmath>

void InputSize(int32_t& size){
    
    std::cout << "Input size: " << std::endl;
    std::cin >> size;
    
    if (size <= 0){
        throw std::invalid_argument("Wrong size");
    }
}

void createArray(double*& array, int32_t size){
    array = new double[size];
}

void fillArray(double* array, int32_t size){
    std::cout << "Input elements:" << std::endl;
    for (int32_t i{0}; i < size; ++i){
        std::cin >> array[i];
    }
}

int32_t findMaxAbsIndex(double* array, int32_t size, double& maxAbsElement) {
    maxAbsElement = array[0];
    int32_t index = 0;

    for (int32_t i = 1; i < size; i++) {
        if (abs(array[i]) > abs(maxAbsElement)) {
            maxAbsElement = array[i];
            index = i;
        }
    }
    return index;
}

int32_t findBalancingIndex(double* array, int32_t size) {
    double totalSum = 0;
    for (int32_t i = 0; i < size; i++) {
        totalSum += array[i];   
    }
    
    double leftSum = 0;
    double minDiff = totalSum;
    int32_t index = -1;

    for (int32_t i = 0; i < size; i++) {
        double rightSum = totalSum - leftSum - array[i];
        double diff = abs(leftSum - rightSum);
        if (diff < minDiff) {
            minDiff = diff;
            index = i;
        }
        leftSum += array[i];
    }
    return index;
}

int32_t findNegative(double* array, int32_t size) {
    int32_t index = -1;
    for (int32_t i = 0; i < size; ++i) {
        if (array[i] < 0) {
            index = i;
            break;
        }
    }
    
    return index;
}

double findSumAfterNegative(double* array, int32_t size, int32_t negativeIndex) {
    double sum{0};
    for (int32_t i = negativeIndex + 1; i < size; ++i) { 
        sum += array[i];   
    }

    return sum;
}

void compressArray(double* array, int32_t size, int32_t p) {
    int32_t index = 0;

    for (int32_t i = 0; i < size; ++i) {
        if (array[i] != p) {
            array[index++] = array[i];
        }
    }

    for (int32_t i = index; i < size; ++i) {
        array[i] = 0;
    }
}


int main(){

    int32_t size{};
    
    try {

        InputSize(size);
        double* array = nullptr;
        createArray(array, size);
        fillArray(array, size);

        double maxAbsElement;
        int32_t maxAbsIndex = findMaxAbsIndex(array, size, maxAbsElement);
        std::cout << "Max abs element: " << maxAbsElement << ", its index: " << maxAbsIndex << std::endl;

        int32_t balancingIndex = findBalancingIndex(array, size);
        std::cout << "Index of an element where is diff is the least: " << balancingIndex << std::endl;
        int32_t negativeIndex = findNegative(array, size);
        if (negativeIndex == -1) {
            std::cout << "There are no negatives in array" << std::endl;
        }
        else {
            double sumAfterNegative = findSumAfterNegative(array, size, negativeIndex);
            std::cout << "Sum of elements after 1st negative: " << sumAfterNegative << std::endl;
        } 
    }
    catch (std::invalid_argument &e){
        std::cout << e.what();
    }

    return 0;
}